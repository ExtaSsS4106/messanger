<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Messenger</title>
<style>
/* --- Основные стили --- */
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #555;
    color: #fff;
}
.container {
    display: flex;
    height: 100vh;
}

/* --- Левая панель --- */
.left-panel {
    width: 300px;
    background: #666;
    display: flex;
    flex-direction: column;
}
.search-box {
    padding: 10px;
}
.search-box input {
    width: 100%;
    padding: 8px;
    border-radius: 6px;
    border: none;
    outline: none;
}
.tabs {
    display: flex;
    justify-content: space-around;
    margin: 10px 0;
}
.tab {
    cursor: pointer;
    padding: 5px 10px;
    border-bottom: 2px solid transparent;
}
.tab.active {
    border-bottom: 2px solid #0f0;
    color: #0f0;
}
.user-list {
    flex: 1;
    overflow-y: auto;
}
.user-item {
    display: flex;
    align-items: center;
    padding: 10px;
    cursor: pointer;
    border-radius: 6px;
    margin: 4px;
    background: #777;
}
.user-item:hover {
    background: #888;
}
.user-avatar {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: #0f0;
    margin-right: 10px;
}

/* --- Кнопки --- */
.actions {
    display: flex;
    margin: 10px;
}
.actions button {
    flex: 1;
    padding: 10px;
    border: none;
    border-radius: 6px;
    margin-right: 5px;
    cursor: pointer;
}
.actions button.green {
    background: #0f0;
    color: #000;
}
.actions button.gray {
    background: #888;
}
.actions a {
    flex: 1;
    text-decoration: none;
    margin-right: 5px;
}
.actions a button {
    width: 100%;
    margin-right: 0;
}

/* --- Правая панель --- */
.right-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: #555;
}
.chat-header {
    padding: 10px;
    background: #666;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.messages {
    flex: 1;
    padding: 10px;
    overflow-y: auto;
}
.message-left, .message-right {
    max-width: 60%;
    margin-bottom: 8px;
    padding: 8px 10px;
    border-radius: 10px;
}
.message-left {
    background: #444;
    align-self: flex-start;
}
.message-right {
    background: #0f0;
    color: #000;
    align-self: flex-end;
}
.input-area {
    display: flex;
    padding: 10px;
    background: #666;
}
.input-area input {
    flex: 1;
    padding: 8px;
    border-radius: 6px;
    border: none;
    outline: none;
}
.input-area button {
    margin-left: 5px;
    padding: 8px 15px;
    border-radius: 6px;
    border: none;
    background: #0f0;
    color: #000;
    cursor: pointer;
}
</style>
</head>
<body>

<div class="container">
    <!-- Левая панель -->
    <div class="left-panel">
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Поиск..." onkeyup="searchUsers()">
        </div>
        <div class="tabs">
            <div class="tab active" id="chatsTab" onclick="switchTab('chats')">Чаты</div>
            <div class="tab" id="friendsTab" onclick="switchTab('friends')">Друзья</div>
            <div class="tab" id="requestsTab" onclick="switchTab('requests')">Запросы</div>
        </div>
        <div class="user-list" id="userList"></div>
        <div class="actions">
            <a href="{% url 'create_group_chat' %}">
                <button class="green">Создать канал</button>
            </a>
            <button class="gray">Добавить в друзья</button>
        </div>
    </div>

    <!-- Правая панель -->
    <div class="right-panel">
        <div class="chat-header" id="chatUserName">Выберите чат</div>
        <div class="messages" id="messagesContainer"></div>
        <div class="input-area">
            <input type="text" id="messageInput" placeholder="Сообщение">
            <button onclick="sendMessage()">→</button>
        </div>
    </div>
</div>

<script>
// === Данные ===
const currentUser = 'User#228';
let activeChatId = null;

let users = [
    {id: 1, name: 'Exti'},
    {id: 2, name: 'Alice'},
    {id: 3, name: 'Bob'}
];

let messages = [
    {chat: 1, user: 'Exti', text: 'Привет!'},
    {chat: 1, user: 'User#228', text: 'Привет, Exti!'}
];

// === Функции ===
function renderMessages() {
    const container = document.getElementById('messagesContainer');
    container.innerHTML = '';
    if (!activeChatId) return;
    messages.filter(m => m.chat === activeChatId).forEach(m => {
        const div = document.createElement('div');
        div.className = m.user === currentUser ? 'message-right' : 'message-left';
        div.innerText = m.text;
        container.appendChild(div);
    });
    container.scrollTop = container.scrollHeight;
}

function openChat(user) {
    activeChatId = user.id;
    document.getElementById('chatUserName').innerText = user.name;
    renderMessages();
}

function displayUsers(list) {
    const container = document.getElementById('userList');
    container.innerHTML = '';
    list.forEach(u => {
        const div = document.createElement('div');
        div.className = 'user-item';
        div.onclick = () => openChat(u);
        div.innerHTML = `<div class="user-avatar"></div><span>${u.name}</span>`;
        container.appendChild(div);
    });
}

function searchUsers() {
    const filter = document.getElementById('searchInput').value.toLowerCase();
    displayUsers(users.filter(u => u.name.toLowerCase().includes(filter)));
}

function switchTab(tab) {
    document.getElementById('chatsTab').classList.remove('active');
    document.getElementById('friendsTab').classList.remove('active');
    document.getElementById('requestsTab').classList.remove('active');
    document.getElementById(tab + 'Tab').classList.add('active');
    displayUsers(users);
}

function sendMessage() {
    const input = document.getElementById('messageInput');
    if (!input.value || !activeChatId) return;
    messages.push({chat: activeChatId, user: currentUser, text: input.value});
    input.value = '';
    renderMessages();
}

displayUsers(users);
</script>

</body>
</html>